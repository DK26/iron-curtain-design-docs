# Iron Curtain — Agent Instructions

> This file is the single source of truth for AI agents working on this project.
> Read this first. Navigate to specific design docs only when you need detail on a topic.

## What This Project Is

**Iron Curtain** is a Rust-native RTS engine built for the C&C community but designed to power any classic RTS (D039). Not a port of OpenRA — a clean-sheet redesign that loads OpenRA's assets, mods, and maps while delivering better performance, modding, and multiplayer. The engine ships with **Red Alert** (default) and **Tiberian Dawn** as built-in game modules; RA2, Tiberian Sun, and community-created games are future modules on the same engine (D018). The project is in pre-development (design phase) as of 2026-02.

- **Language:** Rust
- **Framework:** Bevy (ECS, rendering, audio, asset pipeline)
- **Rendering:** wgpu via Bevy
- **Targets:** Windows, macOS, Linux, Browser (WASM), Steam Deck, Mobile (planned)

## Non-Negotiable Architectural Invariants

Violating any of these is a bug. Do not propose designs that break them.

1. **Simulation is pure and deterministic.** No I/O, no floats, no network awareness in `ic-sim`. Takes orders, produces state. Fixed-point math only (`i32`/`i64`, never `f32`/`f64` in game logic). Same inputs → identical outputs on all platforms.

2. **Network model is pluggable via trait.** `GameLoop<N: NetworkModel, I: InputSource>` is generic over both network model and input source. The sim has zero imports from `ic-net`. They share only `ic-protocol`. Swapping lockstep for rollback touches zero sim code.

3. **Modding is tiered: YAML → Lua → WASM.** Each tier is optional and sandboxed. YAML for data (80% of mods), Lua for scripting (missions, abilities), WASM for power users (total conversions). No C# ever. No recompilation.

4. **Bevy is the framework.** ECS scheduling, rendering, asset pipeline, audio. Custom render passes and SIMD only where profiling justifies it. Pin Bevy version per development phase.

5. **Efficiency-first performance.** Better algorithms → cache-friendly ECS → simulation LOD → amortized work → zero-allocation hot paths → THEN multi-core as a bonus. A 2-core 2012 laptop must run 500 units smoothly (sim target). Render quality tiers down automatically on older GPUs (GL 3.3 fallback → no compute shaders, no post-FX, CPU particles). See `10-PERFORMANCE.md` § "GPU & Hardware Compatibility". Do not reach for `par_iter()` before profiling.

6. **Real YAML, not MiniYAML.** Standard `serde_yaml` with inheritance resolved at load time. A `miniyaml2yaml` converter exists for migration. MiniYAML also loads directly at runtime via auto-conversion (D025) — but all IC-native content uses standard YAML.

7. **OpenRA compatibility is at the data/community layer, not the simulation layer.** Same mods, same maps, shared server browser — but NOT bit-identical simulation. We do not port OpenRA bug-for-bug.

8. **Full resource compatibility.** Every `.mix`, `.shp`, `.pal`, `.aud`, `.oramap`, and YAML rule file from Red Alert and OpenRA must load correctly. The community's existing work is sacred.

9. **Engine core is game-agnostic.** No game-specific enums, resource types, or unit categories in engine core. Positions are 3D (`WorldPos { x, y, z }`). `CellPos` is a game-module convenience for grid-based games, not an engine-core requirement. System pipeline is registered per game module, not hardcoded. Renderer uses a `Renderable` trait. Pathfinding uses a `Pathfinder` trait. Spatial queries use a `SpatialIndex` trait. RA1 sets z=0, registers sprite rendering, multi-layer hybrid pathfinding, and spatial hash — but the engine doesn't know that.

10. **Platform-agnostic by design.** Input is abstracted behind `InputSource` trait (not hardcoded to mouse/keyboard). UI layout is responsive (adapts to screen size via `ScreenClass`). No raw `std::fs` — all assets go through Bevy's asset system. Render quality is runtime-configurable. App lifecycle (suspend/resume) uses sim snapshots. The architecture must not create obstacles for any platform: desktop, browser, mobile, console.

## Crate Structure

```
iron-curtain/
├── ra-formats     # .mix, .shp, .pal, YAML parsing, MiniYAML converter (C&C-specific, keeps ra- prefix)
├── ic-protocol    # PlayerOrder, TimestampedOrder, OrderCodec trait (SHARED boundary)
├── ic-sim         # Deterministic simulation (Bevy FixedUpdate systems)
├── ic-net         # NetworkModel trait + implementations; RelayCore library + relay-server binary
├── ic-render      # Isometric rendering, shaders, post-FX (Bevy plugin)
├── ic-ui          # Game chrome: sidebar, minimap, build queue (Bevy UI)
├── ic-editor      # SDK: scenario editor, asset studio, campaign editor, Game Master mode (D038+D040, Bevy app)
├── ic-audio       # .aud playback, EVA, music (Bevy audio plugin)
├── ic-script      # Lua + WASM mod runtimes
├── ic-ai          # Skirmish AI, mission scripting
├── ic-llm         # LLM mission/campaign generation, asset generation, adaptive difficulty
├── ic-paths       # Platform path resolution: data dirs, portable mode (wraps `app-path` crate)
└── ic-game        # Top-level Bevy App, ties all game plugins together (NO editor code)
```

> **Naming convention (D039):** Engine crates use `ic-*` (Iron Curtain) to reflect the game-agnostic identity. Exception: `ra-formats` keeps its `ra-` prefix because it reads C&C-family file formats specifically.

**Critical boundaries:**
- `ic-sim` NEVER imports from `ic-net`. `ic-net` NEVER imports from `ic-sim`. They only share `ic-protocol`.
- `ic-game` NEVER imports from `ic-editor`. The game and SDK are separate binaries that share library crates.

## Key Design Decisions (Summary)

These are settled. Don't re-litigate unless the user explicitly wants to revisit one. Full rationale is in the thematic sub-documents under `src/decisions/` — see `src/09-DECISIONS.md` for the index.

| ID   | Decision                                                     | Short Rationale                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| ---- | ------------------------------------------------------------ | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| D001 | Rust                                                         | No GC, memory safety, WASM target, no competition in Rust RTS space                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| D002 | Bevy (revised from "No Bevy")                                | ECS is our architecture; saves 2-4 months; plugin system fits pluggable networking                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| D003 | Real YAML, not MiniYAML                                      | `serde_yaml` typed deserialization; standard tooling; no custom parser                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| D004 | Lua for scripting (not Python)                               | Tiny runtime, deterministic, sandboxable, industry standard                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| D005 | WASM for power mods                                          | Near-native perf, perfectly sandboxed, deterministic, polyglot                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| D006 | Pluggable networking via trait                               | Clean sim/net boundary, testable with `LocalNetwork`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| D007 | Relay server as default multiplayer                          | RelayCore is a library in `ic-net`; two deployment modes: standalone binary (dedicated server) or embedded in game client (listen server); blocks lag switches, sub-tick ordering, NAT traversal, signed replays                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| D008 | Sub-tick timestamps on orders                                | CS2-inspired; fairer edge cases; trivial to implement                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| D009 | Fixed-point math, no floats in sim                           | Required for deterministic lockstep; original RA used integer math                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| D010 | Snapshottable sim state                                      | Save games, replays, desync debugging, rollback, automated testing                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| D011 | Cross-engine = community layer, not sim layer                | Bit-identical sim is impractical; shared browser/maps/mods is achievable                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| D012 | Order validation inside sim                                  | Deterministic validation = all clients agree on rejections; validation IS anti-cheat                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| D013 | Pathfinding via `Pathfinder` trait                           | Trait-abstracted; `IcPathfinder` (JPS + flowfield + ORCA-lite) is RA1 impl                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| D014 | Tera templating (Phase 6a, nice-to-have)                     | Eliminates copy-paste for faction variants; load-time only; optional                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| D015 | Efficiency-first, not thread-first                           | Algorithm → cache → LOD → amortize → zero-alloc → THEN parallelism                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| D016 | LLM-generated missions & custom factions (Phase 7, optional) | BYOLLM; output is standard YAML+Lua; game fully functional without LLM; custom faction generation from natural language with Workshop resource integration, balance validation, and skill library few-shot examples; LLM-callable editor tool bindings bridge D038/D040 operations as structured tool-calling schema (Phase 7, editor command registry designed Phase 6a)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| D017 | Bevy rendering pipeline                                      | Classic isometric base; post-FX available as modding infrastructure                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| D018 | Multi-game extensibility (game modules)                      | `GameModule` trait bundles systems, pathfinder, spatial index, fog, etc.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| D019 | Switchable balance presets                                   | Classic RA vs OpenRA vs Remastered vs IC Default; YAML rule sets selectable in lobby; balance philosophy from SC:BW, AoE2, SC2 (asymmetry, counter triangles, spectacle, sparing patches, fun ≠ win rate)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| D020 | Mod SDK & Creative Toolchain                                 | `ic` CLI + IC SDK application; separate binary from the game                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| D021 | Branching campaigns with persistent state                    | Campaign graph, named outcomes, unit roster carry over; OFP-inspired                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| D022 | Dynamic weather with terrain effects                         | Weather state machine + per-cell terrain surface state; deterministic                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| D023 | OpenRA vocabulary compatibility layer                        | Accept OpenRA trait names as YAML aliases; zero migration friction                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| D024 | Lua API superset of OpenRA                                   | OpenRA's 16 globals + IC extensions; OpenRA Lua missions run unmodified                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| D025 | Runtime MiniYAML loading                                     | Auto-converts in memory; `miniyaml2yaml` CLI optional                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| D026 | OpenRA mod manifest compatibility                            | Parse `mod.yaml`; `ic mod import` for migration                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| D027 | Canonical enum compatibility                                 | Match OpenRA locomotor/armor/target/stance enum names exactly                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| D028 | Condition & multiplier systems                               | Phase 2 hard exit criteria, not deferred                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| D029 | Cross-game component library                                 | 7 first-party systems (mind control, carriers, teleport, shields, etc.); Phase 2 target                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| D030 | Workshop resource registry & deps                            | Federated multi-source repository; semver deps; AI consent; phased delivery Phase 4-5+                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| D031 | Observability & telemetry (OTEL)                             | Zero-cost when disabled; gameplay event stream; Grafana dashboards; product analytics (feature usage, navigation, settings, onboarding) in local SQLite — offline-only, no backend transmission, no phone-home; `/analytics export` for voluntary bug report attachment; `/analytics` console commands; unified `telemetry_events` SQLite schema across all components (client + relay + tracking + workshop); servers record to local `telemetry.db` with same export workflow; OTEL is optional export layer for server operators wanting dashboards, never a dependency; comprehensive client event taxonomy (GUI interactions, RTS input patterns, match flow with periodic pace snapshots, session lifecycle, errors, performance sampling); detailed server event taxonomy (game lifecycle, desync detection, lag switches, behavioral analysis)                                                                                                |
| D032 | Switchable UI themes                                         | YAML-driven; Classic/Remastered/Modern presets; community themes via Workshop                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| D033 | Toggleable QoL & behavior presets                            | Every QoL individually toggleable; experience profiles combine D019+D032+D033+D043+D045+D048                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| D034 | SQLite as embedded storage                                   | Open standard — player data is a platform, not a product feature; any tool that speaks SQL can query IC's `.db` files; `rusqlite` for all persistent state; no external DB; single-file deployment; FTS5; WAL; WASM-compatible; backup via `VACUUM INTO`; Library of Congress-recommended archival format; per-database PRAGMA configurations tuned to access pattern and data criticality (FULL sync for identity/credentials/ratings, NORMAL for telemetry/caches; mmap for read-heavy analytical databases; large WAL autocheckpoint for high-throughput telemetry; WASM platform adjustments)                                                                                                                                                                                                                                                                                                                                                     |
| D035 | Creator recognition — voluntary tipping                      | Optional tip links; IC never processes payments; no mandatory paywalls                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| D036 | Achievement system                                           | Per-game-module in SQLite; mod-defined via YAML + Lua; Steam sync                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| D037 | Community governance                                         | RFC process; self-hosting independence; community-elected representatives                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| D038 | Scenario editor (OFP/Eden-inspired, SDK)                     | Visual editor for maps + mission logic; `ic-editor` crate                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| D039 | Engine scope — general-purpose RTS                           | `ic-*` naming; ships RA1+TD; C&C remains primary focus                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| D040 | Asset Studio                                                 | Visual asset browser/editor in IC SDK; format-aware via ra-formats                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| D041 | Trait-abstracted subsystem strategy                          | 5+1 traits: AiStrategy, FogProvider, DamageResolver, RankingProvider, OrderValidator + Transport (D054)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| D042 | Player behavioral profiles & training                        | PlayerStyleProfile from event logs; StyleDrivenAi; privacy-first local replays only                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| D043 | AI behavior presets                                          | Priority-based managers; two-axis difficulty; modder-providable via WASM Workshop                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| D044 | LLM-enhanced AI                                              | LlmOrchestratorAi wraps existing AI; LlmPlayerAi experimental; not ranked                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| D045 | Pathfinding behavior presets                                 | Switchable Pathfinder impls (Remasters/OpenRA/IC); modder-providable via WASM                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| D046 | Community platform — premium content                         | Verified publishers sell cosmetics only; PlatformServices trait; DRM-free                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| D047 | LLM Configuration Manager                                    | Multi-provider UI with task routing; community-shareable configs                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| D048 | Switchable render modes                                      | Bundles backend + camera + resource pack; F1 cycles; cross-view multiplayer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| D049 | Workshop asset formats & P2P                                 | Bevy-native canonical; BitTorrent/WebTorrent for large packages; git-hosted index Phase 0-3                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| D050 | Workshop as cross-project library                            | Standalone Rust library; zero engine dependency; C FFI for non-Rust                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| D051 | GPL v3 with modding exception                                | GPL v3 §7 explicit exception; mods NOT derivative works; same precedent as Linux kernel                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| D052 | Community servers & signed credentials                       | Federated community servers (relay+ranking+matchmaking); local SQLite credential files; Ed25519 signed records (not JWT)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| D053 | Player Profile system                                        | Identity expression, achievement showcase, verified statistics, friends list, community memberships; all reputation data SCR-backed (D052); local-first SQLite storage                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| D054 | Extended switchability                                       | Transport trait (WASM multiplayer), SignatureScheme enum (post-quantum crypto), SnapshotCodec version dispatch (cross-version saves)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| D055 | Ranked tiers, seasons & matchmaking queue                    | YAML-configurable tiers (Cold War military ranks for RA); 3-month seasons with soft reset; 10 placement matches; dual display (tier + rating); Rating Details panel (full Glicko-2 parameter visibility with plain-language explanations, confidence intervals, rating history graph, faction breakdown, population distribution); Glicko-2 RTS adaptations (RD floor=45, per-match updates, match duration weighting, inactivity decay tuned to 91-day seasons, team game weighted-average); faction-specific ratings; small-population matchmaking degradation; community-customizable via D041/D052                                                                                                                                                                                                                                                                                                                                                |
| D056 | Foreign replay import (OpenRA & Remastered)                  | Decode `.orarep` and Remastered replay files via `ra-formats`; direct playback via `ForeignReplayPlayback` NetworkModel; convert to `.icrep` via CLI; automated behavioral regression testing against foreign replay corpus; divergence tracking UI                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| D057 | LLM Skill Library — lifelong learning                        | Persistent, semantically-indexed store of verified LLM outputs (AI strategies + generation patterns); SQLite+FTS5 storage; optional embedding similarity; verification→promotion pipeline; Workshop-shareable; BYOLLM embedding; Voyager-inspired                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| D058 | In-game command console                                      | Unified chat+command system with Brigadier-style command tree; `/` prefix routing; developer console overlay; cvars loadable from `config.toml` (D067); mod-registered commands via Lua/WASM; achievement/ranked flag on dev commands; anti-trolling measures; comprehensive command catalog (every GUI action has a console equivalent); competitive integrity framework (console=GUI parity, D033 toggle governance, order rate monitoring, input source tracking, ranked restrictions, tournament mode); Workshop-shareable console scripts (`.iccmd`, lobby-visible, D033 promotion pipeline); hidden single-player cheat codes (hashed Cold War phrases, trainer-inspired, achievement-flagging)                                                                                                                                                                                                                                                 |
| D059 | In-game communication system                                 | Text chat channels (all/team/whisper/observer); relay-forwarded Opus VoIP on `MessageLane::Voice`; contextual ping system (Apex-inspired, 8 types + ping wheel); chat wheel with auto-translated phrases (Dota 2 pattern); minimap drawing; tactical markers; smart danger alerts; voice-in-replay (opt-in, separate stream, ioquake3 pattern); str0m WebRTC for browser VoIP; Lua API extensions (Ping, ChatWheel, Marker, Chat globals)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| D060 | Netcode parameter philosophy                                 | Three-tier exposure: Tier 1 (lobby GUI) = game speed only; Tier 2 (console/cvars) = `net.*` diagnostics and debug simulation (`DEV_ONLY`/`SERVER` flags); Tier 3 (engine constants) = tick rate (30 tps), sub-tick ordering, adaptive run-ahead, timing feedback, stall policy, anti-lag-switch, visual prediction — all always-on, not configurable. Cross-game survey (Generals, Factorio, CS2, BW, Spring, 0 A.D., AoE2, OpenTTD, original RA) confirms: automate everything, expose almost nothing. Sub-tick is always-on (D008) — the mechanism is automatic but the fairness outcome is player-facing.                                                                                                                                                                                                                                                                                                                                          |
| D061 | Player data backup & portability                             | All player data is local files (SQLite + `.icsave` + `.icrep` + PNG + YAML) in a stable, documented `<data_dir>` layout; `ic backup create/restore` CLI (ZIP + SQLite `VACUUM INTO`); JSON profile export for GDPR data portability (D053 SCRs are self-verifying, cryptographically portable); BIP-39-inspired mnemonic seed recovery (24-word phrase → deterministic Ed25519 key derivation via PBKDF2-HMAC-SHA512, zero infrastructure); optional platform cloud sync via `PlatformServices` trait (Steam Cloud, GOG Galaxy — small critical data only); screenshots as PNG with embedded metadata; no IC-hosted cloud, no proprietary formats                                                                                                                                                                                                                                                                                                     |
| D062 | Mod profiles & virtual asset namespace                       | LVM-inspired layered composition: Source (registered mod) → Profile (named mod set + experience settings + conflict resolutions, saved as YAML, SHA-256 fingerprintable) → Namespace (resolved lookup table mapping logical paths to CAS blobs); profiles are local precursors to published modpacks (D030); lobby fingerprint verification replaces per-mod version checking; `ic profile save/activate/inspect/diff`; `ic mod publish-profile`; editor per-source hot-swap; namespace integrates with Bevy `AssetSource` and D049 local CAS                                                                                                                                                                                                                                                                                                                                                                                                         |
| D063 | Compression strategy                                         | Centralized `CompressionAlgorithm` enum (LZ4 default, zstd future); `CompressionLevel` enum (fastest/balanced/compact); level-configurable per use case via `settings.toml` (D067); algorithm encoded independently in format headers (`compression_algorithm: u8`); users configure level (speed vs. ratio), not algorithm (engine-controlled); `ic replay recompress` CLI; supersedes D054's "no abstraction" compression row — enum (not trait) vindicates D054's no-trait judgment while adding centralization and level control; four-tier configurability (Fixed → User → Server-operator → Toolchain); `AdvancedCompressionConfig` exposes 21 raw parameters for server operators/tournament organizers via `compression.advanced.*` (cvars with `SERVER` flag, relay env vars); platform philosophy: if recompilation is needed, it's a missing feature                                                                                       |
| D064 | Professional server & tournament configuration               | Unified `server_config.toml` (D067) for all server-side parameters (~200 cvars across 14 subsystems); "if recompilation is needed, it's a missing feature" platform philosophy generalized from D063; three-layer config precedence (TOML → env vars → runtime cvars); master parameter registry: relay (15), match lifecycle (7), pause (5), penalties (6), spectator (5), vote framework (~20), protocol limits (11), communication (5), anti-cheat (10), Glicko-2 ranking (9), season (6), matchmaking (6), AI tuning (5), telemetry (5), database (7), Workshop/P2P (9); deployment profiles (tournament LAN, casual community, competitive league, training/practice); validation with range clamping, cross-parameter consistency, unknown-key detection; hot reload via SIGHUP; env var mapping (`IC_RELAY_*`, `IC_MATCH_*`, etc.); `ic server validate-config` CLI                                                                            |
| D065 | Tutorial & new player experience                             | Five-layer system: Commander School tutorial campaign (10 branching Lua-scripted missions via D021 graph), contextual hint overlay (YAML-driven triggers, adaptive suppression, point-of-need teaching), new player pipeline (self-identification gate after D061/D032, skill assessment, difficulty recommendation, tutorial invite), adaptive pacing engine (skill estimate, hint frequency scaling, difficulty calibration), post-game learning (rule-based tips on stats screen, annotated replay mode, progressive feature discovery); tutorial AI tier below D043 Easy; experience-profile-aware (D033 — adapts to Vanilla/OpenRA/Remastered/IC/Custom); all content YAML+Lua moddable (Workshop tutorial packs); no LLM required (Phase 7 coaching optional); multiplayer onboarding (first-time MP flow, ranked explanation, spectator suggestion); campaign pedagogical pacing guidelines with tutorial EVA lines                            |
| D066 | Cross-engine export & editor extensibility                   | SDK exports complete content packages (missions, campaigns, cutscenes, audio, sprites, unit rules) to original Red Alert (.ini/.shp/.aud/.vqa/.mix) and OpenRA (.oramap/MiniYAML/mod.yaml) formats; `ExportTarget` trait with built-in RA1+OpenRA backends + community WASM targets; `ExportPlanner` produces fidelity reports (lossy-by-design: IC features downgraded/stripped with warnings); Lua trigger downcompilation via pattern library (not general transpilation); export-safe authoring mode in scenario editor (feature gating, live fidelity indicators, export-safe trigger templates); `ic export` CLI for batch/CI; editor itself extensible via YAML (custom palettes/panels/brushes) → Lua (validators/batch ops/automation) → WASM (full plugins: custom viewers, terrain tools, export targets); editor extensions distributed via Workshop (D030); bidirectional D023 alias table + D025 MiniYAML converter + D026 mod manifest |
| D067 | Configuration format split — TOML vs YAML                    | TOML for engine/infrastructure configuration (`config.toml`, `server_config.toml`, `settings.toml`, server deployment profiles, `ic.lock`); YAML for game content and mod data (`mod.yaml`, unit/weapon definitions, campaigns, themes, balance presets, maps, triggers, editor extensions); file extension is the instant-recognition signal — `.toml` = how the engine runs, `.yaml` = what the game is; boundary test: "affects simulation or defines content?" → YAML, "configures how software operates?" → TOML; `serde` derive macros identical for both; `toml_edit` for round-trip comment-preserving cvar persistence; three-format taxonomy: TOML (config), YAML (content), SQLite (state)                                                                                                                                                                                                                                                 |
| D071 | External Tool API — IC Remote Protocol (ICRP)                | JSON-RPC 2.0 over WebSocket (primary) + HTTP (fallback) + stdio (MCP/LSP); four permission tiers: observer (fog-filtered read-only), admin (server management), mod (sanctioned commands), debug (BRP passthrough, dev only); reads from post-tick state snapshots (never live ECS), writes through order pipeline (preserving determinism); SHA-256 challenge auth (local), OAuth 2.0 (relay); event subscriptions (push via WebSocket); MCP server for LLM coaching; LSP server (`ic-lsp`) for YAML/Lua mod development in VS Code; Workshop tool packages with declared permissions; ranked mode restricts to observer-with-delay; relay server admin API for tournament tools |
| D072 | Dedicated Server Management                                  | "Just a binary" philosophy — single Rust binary handles relay+matchmaking+admin; five management interfaces: config file (D064), CLI (`ic server *`), built-in web dashboard (embedded HTML/JS, zero deps), in-game admin (D058 commands with identity-key-based admin/moderator roles), ICRP remote (D071); `/health` JSON endpoint (zero-auth); structured logging via `tracing` crate; horizontal scaling (run more instances, not microservices); Docker support optional (first-party Dockerfile); self-update with Ed25519-signed binaries; portable server mode for LAN parties (mDNS discovery); config hot-reload with filesystem watcher |

## Pending Decisions

| ID       | Topic                                                                                                                               | Needs Resolution By |
| -------- | ----------------------------------------------------------------------------------------------------------------------------------- | ------------------- |
| P002     | Fixed-point scale (256? 1024? match OpenRA's 1024?)                                                                                 | Phase 2 start       |
| P003     | Audio library choice + music integration design (see `src/09-DECISIONS.md` § Pending Decisions)                                     | Phase 3 start       |
| P004     | Lobby/matchmaking protocol specifics — PARTIALLY RESOLVED: architecture + lobby protocol defined (D052), wire format details remain | Phase 5 start       |
| ~~P005~~ | ~~Map editor architecture~~ — RESOLVED: Scenario editor in SDK (D038+D040)                                                          | Resolved            |
| ~~P006~~ | ~~License choice~~ — RESOLVED: GPL v3 with modding exception (D051)                                                                 | Resolved            |

## Development Roadmap (36 Months)

```
Phase 0 (Months 1-3)   → Foundation: ra-formats, parse all OpenRA/RA assets, miniyaml2yaml, runtime MiniYAML + alias loading (D023/D025/D026)
Phase 1 (Months 3-6)   → Rendering: Bevy isometric renderer, map loading, visual showcase
Phase 2 (Months 6-12)  → Simulation: ECS sim, movement/combat/harvesting, replay system [CRITICAL]
Phase 3 (Months 12-16) → Game Chrome: sidebar, build queues, audio, first "playable" skirmish
Phase 4 (Months 16-20) → AI & Single Player: Lua scripting, WASM runtime, campaign missions
Phase 5 (Months 20-26) → Multiplayer: lockstep, relay server, desync diagnosis, shared browser
Phase 6a (Months 26-30) → Core Modding + Scenario Editor: full mod compat, in-engine scenario editor (D038), full workshop registry (D030)
Phase 6b (Months 30-34) → Campaign Editor + Game Modes: campaign graph editor, game mode templates, co-op scenario tools, Game Master mode
Phase 7  (Months 34-36) → LLM Missions + Ecosystem + Polish: mission generator, visual effects, ecosystem polish, browser build
```

## Document Navigation

When you need deeper detail, read the specific design doc. Sub-documents are listed indented — read the parent for an overview, then navigate to the specific sub-document for detail.

| Topic                                                                                                                                    | Read                                   |
| ---------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------- |
| Goals, competitive landscape, why this exists                                                                                            | `src/01-VISION.md`                     |
| Crate structure, ECS, sim/render split (core invariants + index to subsystem pages)                                                      | `src/02-ARCHITECTURE.md`               |
| — Extended gameplay systems: power, construction, production, harvesting, combat, fog, shroud, crates, veterancy, superweapons           | `src/architecture/gameplay-systems.md` |
| — Game loop, state recording, pathfinding, platform portability, UI themes, crate graph, install layout, SDK/editor, type-safety         | `src/architecture/*.md` (13 files)     |
| NetworkModel trait, relay server, CS2 sub-tick, lockstep, adaptive run-ahead                                                             | `src/03-NETCODE.md`                    |
| — Match lifecycle: lobby, loading, tick processing, pause, disconnect, desync, replay, post-game                                         | `src/netcode/match-lifecycle.md`       |
| YAML rules, Lua scripting, WASM modules, sandboxing, LLM metadata, Mod SDK                                                               | `src/04-MODDING.md`                    |
| — Campaign system: branching graphs, persistent state, unit carryover, co-op                                                             | `src/modding/campaigns.md`             |
| — Workshop: federated registry, P2P distribution, semver deps, modpacks, moderation, creator reputation, Workshop API                    | `src/modding/workshop.md`              |
| File formats, EA source code insights, coordinate systems                                                                                | `src/05-FORMATS.md`                    |
| Threat model, maphack, order validation, replay signing, protocol hardening                                                              | `src/06-SECURITY.md`                   |
| Cross-engine play, OrderCodec, SimReconciler, ProtocolAdapter                                                                            | `src/07-CROSS-ENGINE.md`               |
| 36-month phased roadmap with exit criteria                                                                                               | `src/08-ROADMAP.md`                    |
| Decision log — index with links to all 54 decisions                                                                                      | `src/09-DECISIONS.md`                  |
| — Decisions: Language, Bevy, YAML, fixed-point, snapshots, efficiency, rendering, multi-game, engine scope, config format                | `src/decisions/09a-foundation.md`      |
| — Decisions: Pluggable net, relay, sub-tick, cross-engine, order validation, community servers, ranked, netcode params                   | `src/decisions/09b-networking.md` → `src/decisions/09b/D0XX-*.md` |
| — Decisions: Lua, WASM, Tera, UI themes, Workshop lib, GPL v3, mod profiles, cross-engine export                                         | `src/decisions/09c-modding.md`         |
| — Decisions: Pathfinding, balance, QoL, trait subsystems, AI presets, LLM AI, render modes, extended switchability                       | `src/decisions/09d-gameplay.md` → `src/decisions/09d/D0XX-*.md` |
| — Decisions: Workshop, telemetry, SQLite, achievements, governance, premium, profiles, data backup                                       | `src/decisions/09e-community.md` → `src/decisions/09e/D0XX-*.md` |
| — Decisions: LLM missions, scenario editor, asset studio, LLM config, foreign replay, skill library                                      | `src/decisions/09f-tools.md` → `src/decisions/09f/D0XX-*.md` |
| — Decisions: Command console, communication (chat, voice, pings), tutorial/new player experience                                         | `src/decisions/09g-interaction.md` → `src/decisions/09g/D0XX-*.md` |
| Efficiency pyramid, profiling, performance targets, benchmarks                                                                           | `src/10-PERFORMANCE.md`                |
| OpenRA feature catalog (~700 traits), gap analysis, migration mapping                                                                    | `src/11-OPENRA-FEATURES.md`            |
| Combined Arms mod migration, Remastered recreation feasibility                                                                           | `src/12-MOD-MIGRATION.md`              |
| Development philosophy, design review principles, C&C creator lessons, narrative identity guidelines                                     | `src/13-PHILOSOPHY.md`                 |
| Development methodology, context-bounded work units, research rigor                                                                      | `src/14-METHODOLOGY.md`                |
| Server admin guide: configuration, deployment profiles, tournament ops, best practices                                                   | `src/15-SERVER-GUIDE.md`               |
| Coding standards: file structure, commenting philosophy, naming, error handling, testing, code review                                    | `src/16-CODING-STANDARDS.md`           |
| Player flow & UI navigation: UX principles, state machine, and index to per-screen sub-pages                                            | `src/17-PLAYER-FLOW.md`                |
| — Per-screen flows: first launch, main menu, single player, multiplayer, in-game, post-game, replays, workshop, settings, profile, SDK   | `src/player-flow/*.md` (16 files)      |

## Legal Protections

### Trademark Disclaimer

Red Alert, Tiberian Dawn, Command & Conquer, and C&C are trademarks of Electronic Arts Inc. Iron Curtain is **not** affiliated with, endorsed by, or sponsored by Electronic Arts. These names are used solely to identify the games and formats the engine is designed to be compatible with (nominative fair use). This disclaimer MUST appear in `README.md` and MUST NOT be removed or weakened.

When writing public-facing text that references EA game titles:
- Use the trademark name to identify the game, not as if IC *is* that game
- Never imply EA endorsement, sponsorship, or partnership
- Do not use EA logos or proprietary art assets
- "Red Alert game module" or "compatibility with Red Alert" — not "our Red Alert"

### Asset Distribution Policy

Iron Curtain does **not** distribute any copyrighted game assets (sprites, audio, video, music). The engine loads assets from games users already own — the same model as OpenRA, Wargus, and other open-source engine reimplementations. This is a non-negotiable legal boundary.

- Never commit copyrighted EA assets to any IC repository
- Theme art (D032) must be original creations — never copied from EA or OpenRA
- Format codecs in `ra-formats` reference EA's GPL-licensed source code — this is legal use under GPL
- Workshop resources are user-submitted with mandatory SPDX licensing — IC is not liable for user-uploaded content

### Engine License

Engine source code is **GPL v3 with an explicit modding exception** (D051). The modding exception uses GPL v3 § 7 to clarify that YAML, Lua, and WASM mods loaded through the engine's data interfaces are NOT derivative works — modders choose their own license. Engine modifications remain GPL v3. See `LICENSE` for the full text.

### Design Documentation License

All files in `src/` and `research/` are licensed under **CC BY-SA 4.0** (Creative Commons Attribution-ShareAlike 4.0 International). This is separate from the engine code license.

### Contributor License

The project requires a **Developer Certificate of Origin (DCO)** — contributors add `Signed-off-by: Name <email>` to commit messages (`git commit -s`). A CI check verifies compliance. No CLA paperwork required. Same model as the Linux kernel.

### Privacy & Data Protection

- **Local-first by default.** Telemetry, match history, profiles stay on-device unless user opts in.
- **No PII in telemetry.** Player IDs are anonymized. No names, emails, or IPs in gameplay telemetry.
- **Right to deletion + data portability.** Server-side data deletable on request; export in standard format.
- **GDPR compliance** required before deploying any server processing EU user data.
- **Relay data minimization.** Retain connection logs only for abuse prevention; purge after retention window.

### Workshop Legal Requirements

- **Minimum age:** 13+ (COPPA compliance).
- **Third-party content disclaimer:** IC is not liable for Workshop content.
- **DMCA safe harbor:** See `src/decisions/09e/D030-workshop-registry.md` for takedown process.

### Legal Operational Milestones

These are not design decisions — they are operational/legal tasks tied to specific development phases.

- **Phase 0:** Establish `deny.toml` and `cargo deny check licenses` in CI. Add SPDX headers to all source files from first commit. DCO enforcement (signed-off-by CI check) active from first commit.
- **Before Phase 5 (multiplayer + Workshop):** Form a legal entity (foundation, nonprofit, or LLC) to hold project assets and limit personal liability for server operations, user data, and DMCA obligations. Reference models: Godot Foundation, Blender Foundation, Software Freedom Conservancy.
- **Before Phase 5 (Workshop launch):** Register a DMCA designated agent with the U.S. Copyright Office (required for safe harbor protection under 17 U.S.C. § 512 before accepting user uploads).
- **Optional (before Phase 5):** Consider registering "Iron Curtain" as a trademark in software/games (USPTO Class 9/41). Not legally required — common law trademark rights accrue through use — but registration gives presumptive nationwide priority. "Iron Curtain" is a Cold War historical term (Churchill, 1946) with no existing EA trademark registration; the project name references the historical/thematic setting, not EA's in-game superweapon.

## Working With This Codebase

### Version Control
- **Never run `git commit`, `git push`, or any command that creates or modifies commits.** A commit is the maintainer's signature that the changes are correct. Only the maintainer can make that determination. Agents edit files; the maintainer reviews, commits, and pushes.
- You may run read-only git commands (`git status`, `git diff`, `git log`, etc.) to understand the current state of the repository.

### mdbook
- **Never run `mdbook build`, `mdbook serve`, or any mdbook command.** The book is built manually by the maintainer when ready. Only edit the markdown source files in `src/`.
- **When linking to design docs from public-facing files (README, etc.), use the hosted mdbook URL:** `https://dk26.github.io/iron-curtain-design-docs/`. Link to `.html` pages (e.g., `01-VISION.html`), not the raw `src/*.md` source files.

### Implementation Overlay Discipline (Milestones / Dependencies / Priority)

This project uses an **execution overlay** (milestones `M0–M11`, feature clusters, dependency DAG) in addition to the canonical phase roadmap. Agents must keep new features correctly placed in that overlay.

**Rule:** A newly added feature (mode, UI flow, tooling capability, platform adaptation, community feature, etc.) is **not considered integrated into the project plan** until it is mapped into the implementation overlay.

Required in the **same change set**:
1. Assign a **priority class** (`P-Core`, `P-Differentiator`, `P-Creator`, `P-Scale`, `P-Optional`)
2. Assign a **primary milestone** (`M0–M11`)
3. Record **dependency placement** (hard / soft / validation / policy / integration) where applicable
4. Update tracker representation:
   - `src/18-PROJECT-TRACKER.md` (Dxxx row and/or milestone impact)
   - `src/tracking/milestone-dependency-map.md` (feature cluster + dependency edges)

Additional rules:
- **Do not append unsorted “later” feature ideas** into planning docs without placing them in milestone sequence.
- **Mark experimental/optional features explicitly** so they do not silently creep into core milestones.
- A feature may be documented as a proposal/idea without tracker placement, but it is **not scheduled/planned work** until mapped into the overlay.

Canonical references:
- `src/18-PROJECT-TRACKER.md` (what next / status overlay)
- `src/tracking/milestone-dependency-map.md` (what blocks what)
- `src/tracking/testing-strategy.md` (how is it tested / CI pipeline tiers / fuzz targets / release criteria)
- `src/14-METHODOLOGY.md` (tracker integration gate + process discipline)
- For external implementation repos: `src/tracking/external-code-project-bootstrap.md`, `src/tracking/external-project-agents-template.md`, `src/tracking/source-code-index-template.md`

### Future / Deferral Language Discipline

Canonical docs must not contain **ambiguous future intent**. The word `future` itself is allowed, but future-facing commitments must be explicit and planned.

**Rule:** Any future-facing design commitment in canonical docs (`src/**/*.md`, `README.md`, `AGENTS.md`) must be one of:
- **Planned deferral** (mapped to milestone/priority/dependencies in the execution overlay)
- **North Star / vision** (explicitly labeled as non-promise with trust/fairness caveats where relevant)
- **Versioning/evolution statement** (current version + migration/version path defined)
- **Narrative/historical/legal usage** (clearly non-planning context)

Required in the **same change set** when adding a future-facing commitment:
1. Classify the statement (planned deferral / north star / versioning / exempt context)
2. If it is planned work, map it into:
   - `src/18-PROJECT-TRACKER.md`
   - `src/tracking/milestone-dependency-map.md`
3. If it is not yet placeable, label it explicitly as:
   - **proposal-only** (not scheduled), or
   - a **Pending Decision (`Pxxx`)**

Banned in canonical planning/spec wording unless immediately resolved in the same sentence:
- vague phrases like `future convenience`, `later maybe`, `could add later`, `might add later`
- `deferred` without saying **to what** and **why**
- `nice-to-have` without explicit phase/milestone and optionality

Canonical references:
- `src/tracking/future-language-audit.md` (classification + remediation queue)
- `src/tracking/deferral-wording-patterns.md` (wording transformations / examples)

### Code Style
- Idiomatic Rust. Use `clippy` and `rustfmt`.
- Prefer zero-allocation patterns in hot paths. Use `Vec::clear()` over `Vec::new()`.
- No floats in `ic-sim`. Fixed-point only.
- Every public type in `ic-sim` must derive `Serialize, Deserialize` (for snapshots).
- System execution order in `ic-sim` is fixed and documented. Adding a new system requires deciding where in the order it runs and documenting why.
- **Every source file** must begin with an SPDX header: `// SPDX-License-Identifier: GPL-3.0-or-later` followed by `// Copyright (c) 2025–present Iron Curtain contributors`. Established from the first commit for consistency.
- Run `cargo deny check licenses` in CI to catch GPL-incompatible transitive dependencies early. Add `deny.toml` to the repository root in Phase 0.
- **Full coding standards** (file structure, commenting philosophy, naming conventions, error handling, testing patterns, code review checklist) are in `src/16-CODING-STANDARDS.md`.

### When Adding a New Feature
1. Check `src/09-DECISIONS.md` (decision index) — has this been decided already? Follow the link to the relevant sub-document.
2. Check the roadmap (`src/08-ROADMAP.md`) — which phase does this belong to?
3. Respect the crate boundaries — especially `ic-sim` ↔ `ic-net` via `ic-protocol` only.
4. If it touches performance, read `src/10-PERFORMANCE.md` and follow the efficiency pyramid (algorithm first, threading last).
5. If it touches networking, ensure the sim remains unaware — work through the `NetworkModel` trait.
6. If it touches modding, respect the tiered model and sandbox constraints.
7. Consider community impact — does this address a known pain point or create new friction? Check `src/01-VISION.md` and `src/11-OPENRA-FEATURES.md`.
8. If adding a new resource type, consider including an `llm:` metadata block. See `src/04-MODDING.md` § "LLM-Readable Resource Metadata".

### Design & Code Review Philosophy

Guided by `src/13-PHILOSOPHY.md` (C&C creator principles, OpenRA lessons). Key rules for agents:

0. **"Is this the game the community actually wants?"** — Every decision must serve a playable game real people want to play.
1. **"Does this make the toy soldiers come alive?"** — Features serve the core fantasy or need strong justification.
2. **Fun beats documentation** — If it plays well but contradicts the doc, update the doc. If it's in the doc but plays poorly, cut it.
3. **Separate simulation from I/O** — The sim survives decades. Keep it pure. Rendering and networking are replaceable.
4. **Data-driven everything** — Game values belong in YAML, not code.
5. **Scope to what you have** — Two less-than-excellent systems are worse than one excellent system.
6. **Build with the community, not just for them** — Community pain points are primary design inputs.
7. **Narrative identity: earnest commitment, never ironic distance** — C&C plays everything straight at maximum volume. Content (briefings, dialogue, cheat names, LLM prompts) follows the seven C&C narrative pillars in Principle #20.

### Handling External Feedback & Reviews

Treat feedback as input, not instruction. Validate every claim before acting.

1. **Verify the factual claim.** Read the text being criticized. Is the characterization accurate?
2. **Evaluate against project architecture.** Does the fix respect crate boundaries and invariants?
3. **Accept, adapt, or defer — and be explicit about which.** Accept valid fixes. Adapt when the intent is right but the suggestion is imprecise. Defer when it belongs to a different scope/phase.
4. **Don't accept all feedback uncritically.** Reviewers can be wrong. But if three people flag the same paragraph, the paragraph has a problem.

### Known Duplication to Fix
- Performance details appear in both `src/decisions/09a-foundation.md` (D015) and `src/10-PERFORMANCE.md` — the latter is canonical

### Mistakes to Never Repeat
These are specific errors made by agents on this project. Read them before editing any public-facing file.

1. **Agent wrote "design documents are complete" and "implementation beginning" in README.** Neither was true — design is in progress, no code exists. Never declare project status. Only the maintainer decides that.

2. **Agent added author name to FOREWORD.md and README.md but forgot `book.toml` and `00-INDEX.md`.** User had to point out each missing file. When a change touches multiple files, scan all of them first: `AGENTS.md`, `README.md`, `book.toml`, `src/00-INDEX.md`, `src/SUMMARY.md`, `src/FOREWORD.md`, and any design doc that references the topic. Update everything in one pass.

3. **README used present tense for features that don't exist:** "loads your existing OpenRA mods," "your OpenRA mods just work," "eliminates lag switching," "runs headless for AI training." Nothing is implemented. Use future tense: "will load," "designed to," "targets."

4. **README Resource Compatibility table used ✅ checkmarks for planned features.** ✅ means "done." Nothing is done. Use phase numbers or "planned" labels instead.

5. **FOREWORD used jargon a non-technical reader would need to Google:** "borrow checker," "ECS," "dangling pointers," "segfaults," "use-after-free," "buffer overflows," "data races," "GC pauses," "memory layout," "runtime overhead." Public-facing docs should explain what Rust *does for the user* (fast, safe, reliable), not compiler internals. Technical terms belong in `src/01-VISION.md` through `src/12-MOD-MIGRATION.md`.

6. **Don't romanticize the project or dramatize the author's voice.** The author's tone is direct and honest. Avoid motivational-speaker copy — no "love letters," no dramatic origin stories, no rallying cries. State things plainly.

7. **Don't infer relationships between facts the author shares.** If two things are mentioned separately, don't imply they happened simultaneously, are causally linked, or share a timeline unless the author explicitly says so.

8. **Be honest about what competing projects can do.** Don't downplay or dismiss features of OpenRA or other projects to make Iron Curtain look better. If a competitor does something well, say so accurately.

9. **README architecture diagram showed 8 crates when AGENTS.md lists 11.** Missing: `ic-protocol` (the most critical shared boundary), `ic-audio`, `ic-game`. Diagrams and tables derived from AGENTS.md must match it exactly — if AGENTS.md lists 11 crates, the README diagram shows 11 crates.

10. **Docs stated unverified performance numbers and architecture claims about OpenRA and the Remastered Collection as fact.** Example: "Stutters at 300-500 units," "30-60ms tick time," "~2-4KB per unit," "fixed rendering pipeline," "SDL/OpenGL basic rendering." None of these were benchmarked or cited. When comparing to competitors: (a) state what is verified from source code, (b) label estimates as estimates, (c) cite issue tracker numbers when claiming bug frequency, (d) don't speculate about internal architecture unless you've read the code.

### Reference Material

Projects we actively study. Detailed analysis in `research/` and design docs.

- **EA Red Alert source:** https://github.com/electronicarts/CnC_Red_Alert (GPL v3) — Canonical gameplay values, order pattern, integer math
- **EA Remastered Collection:** https://github.com/electronicarts/CnC_Remastered_Collection — UI/UX gold standard; GPL v3 covers C++ engine DLLs only
- **EA Generals / Zero Hour:** https://github.com/electronicarts/CnC_Generals_Zero_Hour (GPL v3) — Netcode reference; see `research/generals-zero-hour-netcode-analysis.md`
- **EA Tiberian Dawn:** https://github.com/electronicarts/CnC_Tiberian_Dawn — Shared C&C engine lineage; future TD module reference
- **OpenRA:** https://github.com/OpenRA/OpenRA — Architecture/UX patterns; issue tracker as community pain point radar; do NOT copy unit balance (D019)
- **OpenRA Mod SDK:** https://github.com/OpenRA/OpenRAModSDK — Mod developer experience reference for D020
- **Chrono Divide** — TypeScript browser RTS; architecture reference for WASM target
- **Stratagus:** https://github.com/Wargus/stratagus (GPL-2.0) — Game-agnostic RTS engine; Lua AI scripting; see `research/stratagus-stargus-opencraft-analysis.md`
- **Stargus:** https://github.com/Wargus/stargus — Kaitai Struct format-as-schema approach relevant to `ra-formats`
- **Embark Studios (Rust gamedev):** https://github.com/EmbarkStudios — Quilkin UDP proxy (relay architecture), cargo-deny (license CI), puffin (frame profiler); see `research/embark-studios-rust-gamedev-analysis.md`
- **Godot Engine:** https://github.com/godotengine/godot (MIT) — GDExtension ABI, MultiplayerAPI trait, ResourceFormatLoader; see `research/godot-o3de-engine-analysis.md`
- **O3DE (Open 3D Engine):** https://github.com/o3de/o3de (Apache 2.0) — Gem modular system, AzNetworking transport separation; see `research/godot-o3de-engine-analysis.md`
- **Mojang (Minecraft):** https://github.com/Mojang — Brigadier command parser, Bedrock data-driven entities, DataFixerUpper migration; see `research/mojang-wube-modding-analysis.md`
- **Wube Software (Factorio):** https://github.com/wube/factorio-data — "Game is a mod" architecture, three-phase data loading, deterministic multiplayer with mods; see `research/mojang-wube-modding-analysis.md`
- **Ranked matchmaking systems (CS2, SC2, LoL, Valorant, Dota 2, OW2, AoE4, C&C Remastered):** Cross-game competitive ranking analysis; see `research/ranked-matchmaking-analysis.md`
- **uBlock Origin:** https://github.com/gorhill/uBlock (GPL-3.0) — Token-dispatch fast-path matching, flat-array struct-of-arrays data layout, BidiTrie compact trie, community filter list trust tiers, three-layer cheapest-first evaluation, allow/block priority realms; see `research/ublock-origin-pattern-matching-analysis.md`
